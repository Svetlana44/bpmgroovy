# Тестирование асинхронной операции через брокер (Kafka/RabbitMQ)

## Подход

1. Отправить событие/команду в брокер
2. Дождаться результата:
   - через polling к БД
   - через отдельную очередь результата
   - через REST‑endpoint статуса
3. Проверить таймауты и ретраи

## Практические приёмы

- фиксированные id/correlationId
- ожидания с таймаутом и экспоненциальным backoff
- проверка идемпотентности
- тесты на повторную доставку

## Пример (словами)

Отправляем событие `PaymentRequested`, затем ждём появления записи в БД
с тем же correlationId и статусом `Processed`. Если не появилось за 30с —
тест падает.
